<div class="content-grid dash-area">
  <!-- <h1>Pages#dashboard</h1> -->
  <div class="dashboard-user-panel-links-shell shell-border grey-shell-gradient">
    <div class="user-profile-image-div">
      <!--added -->
      <!-- for face detection -->
      <div class="icon-div">
        <% avatar_url = @current_user.photo.url(:bright_face) || avatar_url = "https://res.cloudinary.com/mattg/image/upload/v1494130069/user-icon_arl6kj.png" %>
        <!-- ^ added `.url(:brightface)` from the `photo_uploader` class-->
        <div class="user-large-profile-image-img icon-shell" style="background-image: url('<%= image_path avatar_url %>'); background-size: cover;  height: 180px; width: 180px; border-radius: 50%; background-position: center;"></div>
      </div><!--end of icon-div-->
      <!--added -->
    </div><!--end of user-profile-image-div find: _usericon.scss-->
    <div class="header-items">
      <!-- <i class="far fa-envelope fa-3x"></i> -->
      <h5>Private Messages</h5>
      <div class="counter"><%= @privatemessages.size %></div>
    </div>
    <div class="dashboard-user-info-div">
      <h6 class=""><%= current_user.fname %></h6>
      <h6 class=""><%= current_user.email %></h6>
    </div><!--end of dashboard-user-info-div-->
    <ul class="dashboard-user-panel-links-list">
      <li><%= link_to "new consult", new_consultation_path %></li>
      <li><%= link_to "about me", about_path %></li>
      <li><%= link_to "messages", dashboard_path %></li>
      <li><%= link_to "all consultations", consultations_path %></li>
    </ul><!--end of dashboard-user-panel-links-list -->
  </div><!--end of dashboard-user-panel-links-shell-->
  <div class="dashboard-messages-shell shell-border blue-shell-gradient">
    <div class="dashboard-message header-items">
      <div class="message-header-item"><h4 class="dashboard-messages-header">Messages</h4></div>
      <div class="message-header-item counter"><%= @my_messages_array.size %></div>
    </div><!--end of dashboard-message header-items-->
     <% @consultations.each do |c| %>
      <% c.messages.last(1).each do |m| %>
        <%= link_to message_path(m), class: "no-decor" do %>
          <div class="shell-tab grey-tab-gradient">
            <h5><b><%= m.subject %></b></h5>
            <%= truncate(m.textmess, length: 35) %> <!--this limits the length of message text-->
          </div><!--end of shell-tab-->
        <% end %><!--end of link_to message_path-->
      <% end %><!--end of c.messages.each -->
    <% end %><!--end of @consultations.each-->
  </div><!--end of dashboard-messages-shell-->
  <div class="dashboard-consults-shell shell-border blue-shell-gradient">
    <div class="dashboard-consult header-items">
      <div class="consult-header-item"><h4 class="dashboard-consults-header">Consultations</h4></div>
      <div class="consult-header-item counter"><%= @my_cons_appointments_array.size %></div>
    </div><!--end of dashboard-consult header-items-->
    <div class="dashboard-consults-div">
      <% @my_consult_array.sort{|x,y| y <=> x}.take(3).each do |a| %>
      <!-- @my_consult_array_desc from controller-->
      <!-- ^c.appointment => each consult has appointments-->
      <!-- ^^ pushes each consultation appointment into an array and reverses the order-->
        <%= link_to appointment_path(a) do %>
          <div class="flex-space-between shell-tab grey-tab-gradient">
            <div class="consult-item">
              <% avatar_url = a.user.photo.url(:bright_face) || avatar_url = "https://res.cloudinary.com/mattg/image/upload/v1494130069/user-icon_arl6kj.png" %>
              <!-- ^ added `.url(:brightface)` from the `photo_uploader` class-->
              <div class="user-sm-profile-image-img icon-shell icon-shell" style="background-image: url('<%= image_path avatar_url %>'); background-size: cover;  height: 50px; width: 50px; border-radius: 50%; background-position: center;"></div>
            </div><!--end of icon-div-->
            <div class="consult-item"><%= a.start.strftime('%B %d @ %I:%M%p')%></div>
          </div><!--end of shell-tab-->
        <% end %><!--end link_to-->
      <% end %><!-- end of @my_consult_array_desc-->
    </div><!--end dashboard-consults-div-->
  </div><!-- end dashboard-consults-shell-->
  <div class="dashboard-appointments-shell shell-border blue-shell-gradient">
    <div class="dashboard-appointment header-items">
      <div class="appointment-header-item"><h4 class="dashboard-appointments-header">Appointments</h4></div>
      <div class="appointment-header-item counter"><%= @appointments.size %></div>
    </div><!--dashboard-appointment header-items-->
    <div class="dashboard-appointments-div">
      <% @appointments.last(3).each do |a| %>
        <%= link_to appointment_path(a), class: "no-decor" do %>
          <div class="dashboard-user-appointments-div flex-space-between shell-tab grey-tab-gradient">
            <div class="icon-div">
              <% avatar_url = a.consultation.user.photo.url(:bright_face) || avatar_url = "https://res.cloudinary.com/mattg/image/upload/v1494130069/user-icon_arl6kj.png" %>
                <!-- ^ added `.url(:brightface)` from the `photo_uploader` class-->
              <div class="user-sm-profile-image-img icon-shell icon-shell" style="background-image: url('<%= image_path avatar_url %>'); background-size: cover;  height: 50px; width: 50px; border-radius: 50%; background-position: center;"></div>
            </div><!--end of icon-div-->
            <div><%= a.start.strftime('%B %d @ %I:%M%p')%></div>
          </div><!-- end of dashboard-user-appointments-div-->
        <% end %><!--end of link_to-->
      <% end %><!-- end of current_user.appointments.each do -->
    </div><!--end of dashboard-appointments-div-->
  </div><!--end of dashboard-appointments-shell"-->
  <div class="dashboard-consults-product-shell shell-border blue-shell-gradient">
    <div class="dashboard-product header-items">
      <div class="product-header-item"><h4 class="dashboard-consults-product-header">Services</h4></div>
      <div class="product-header-item counter"><%= @consultations.size %></div>
    </div><!--end of dashboard-product header-items-->

    <div class="dashboard-consults-product-div">
      <% @consultations.limit(3).each do |c| %>
          <div class="flex-space-between dashboard-consults-product-items shell-border shell-tab grey-tab-gradient">
            <div class="dashboard-product-item"><%= c.language %></div>
            <div class="dashboard-product-item"><%= c.consulttype %></div>
            <div class="dashboard-product-item"><%= number_to_currency(c.consultfee, unit: "â‚©") %></div>
          <div class="dashboard-product-item"><%= link_to consultation_path(c) do %>
            <i class="fas fa-eye" aria-hidden="true"></i><% end %>
          </div>
          <div class="dashboard-product-item"><%= link_to consultation_path(c), method: :delete do %>
            <i class="fas fa-trash-alt" aria-hidden="true"></i><% end %>
          </div>
        </div><!--end of flex-space-between dashboard-consults-product-items shell-border shell-tab-->
      <% end %><!-- end of current_user.consultations.each do-->
    </div><!-- end of dashboard-consults-product-div -->

  </div><!--end of dashboard-consults-product-shell-->
  <div class="dashboard-consults-reviews-shell shell-border blue-shell-gradient">
    <div class="dashboard-review header-items">
      <div class="review-item"><h4>RecentReviews</h4></div>
      <div class="review-item counter"><%= @my_reviews_array.size %></div>
    </div><!--end of dashboard-review header-items-->
    <% @consultations.each do |c| %>
      <% c.reviews.each do |r| %>
        <%= link_to review_path(r.id), class: "no-decor" do %>
          <div class="shell-tab flex-space-between dashboard-review-list-items grey-tab-gradient">
            <div class= "review-item">
              <%= r.star %>
              <% r.star.to_i.times do %>
                <i class="fa fa-star yellow-star"></i><!--reference 'components/_reviewstars.scss'-->
                <% end %><!--end of r.star-->
              <% (5 - r.star.to_i).times do %>
                <i class="fa fa-star grey-star"></i><!--reference 'components/_reviewstars.scss'-->
             <% end %><!--end of 5-r.star-->
            </div><!--end of review-item-->
            <div class="review-item">
              <%= truncate( r.comment, length: 15) %>
            </div><!--end of review-item-->
          </div><!--shell-tab dashboard-review-list-items-->
        <% end %><!--end of link_to review-->
      <% end %><!--end c.review-->
    <% end %><!--end of @consultion.each-->
  </div><!--end dashboard-consults-reviews-shell-->
  <div class="dashboard-clients-list-shell shell-border blue-shell-gradient">
    <div class="dashboard-client header-items">
      <div class="client-item"><h4 class="dashboard-clients-header">Clients</h4></div>
      <div class="client-item counter"><%= @my_clients_array.size %></div>
    </div><!--dashboard-client header-items-->
      <div class="dashboard-clients-div">
        <% @my_clients_array.each do |client| %> <!-- @my_client_array in pages#dashboard-->
          <%= link_to user_path(client) do %>
            <div class="shell-tab flex-space-between dashbaoard-client-list-items grey-tab-gradient">
              <div class="client-item">
              <% avatar_url = client.photo.url(:bright_face) || avatar_url = "https://res.cloudinary.com/mattg/image/upload/v1494130069/user-icon_arl6kj.png" %>
              <div class="user-sm-profile-image-img icon-shell icon-shell" style="background-image: url('<%= image_path avatar_url %>'); background-size: cover;  height: 50px; width: 50px; border-radius: 50%; background-position: center;"></div>
              </div><!--end of client-item-->
              <div class="client-item"><%= client.fname %></div>
            </div><!--end of client-item-->
          <% end %>
        <% end %><!--end of @my_clients_array.each-->
      </div><!--end of shell-tab flex-space-between dashbaoard-client-list-items-->
    </div><!--end of dashboard-clients-div-->
  </div><!--dashboard-clients-list-shell-->
</div><!--end of grid div-->
